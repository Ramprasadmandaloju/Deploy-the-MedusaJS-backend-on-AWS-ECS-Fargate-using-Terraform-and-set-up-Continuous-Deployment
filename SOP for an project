 Standard Operating Procedure (SOP)
ğŸš€ Deploying Medusa Headless Commerce Backend on AWS ECS with Terraform and GitHub Actions
ğŸ“Œ Objective
This SOP outlines the step-by-step instructions to deploy the MedusaJS backend on AWS ECS (Fargate) using Terraform and implement a CI/CD pipeline using GitHub Actions.

ğŸ“ Project Structure
bash
Copy
Edit
medusa-aws-deployment/
â”œâ”€â”€ .github/workflows/deploy.yml     # GitHub Actions pipeline
â”œâ”€â”€ terraform/                       # Terraform files for AWS infrastructure
â”‚   â”œâ”€â”€ main.tf
â”‚   â”œâ”€â”€ variables.tf
â”‚   â””â”€â”€ outputs.tf
â”œâ”€â”€ medusa-server/                   # MedusaJS backend (Dockerized)
â”‚   â””â”€â”€ Dockerfile
â””â”€â”€ README.md or SOP.md              # This SOP
âœ… Prerequisites
AWS Account

GitHub Account

Tools installed:

Docker

Terraform

Node.js (v16+)

AWS CLI

ğŸ”§ Step-by-Step Instructions
ğŸ”¹ 1. Clone the Repository
bash
Copy
Edit
git clone https://github.com/YOUR_USERNAME/medusa-aws-deployment.git
cd medusa-aws-deployment
ğŸ”¹ 2. Set Up AWS CLI
bash
Copy
Edit
aws configure
Provide:

AWS Access Key ID

AWS Secret Access Key

Default region (e.g., us-east-1)

Default output format (press Enter for none)

ğŸ”¹ 3. (Optional) Build and Push Docker Image to ECR
This step can also be handled by GitHub Actions (Step 7).

bash
Copy
Edit
cd medusa-server
docker build -t medusa-server .
aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin <AWS_ID>.dkr.ecr.us-east-1.amazonaws.com
docker tag medusa-server:latest <AWS_ID>.dkr.ecr.us-east-1.amazonaws.com/medusa-server:latest
docker push <AWS_ID>.dkr.ecr.us-east-1.amazonaws.com/medusa-server:latest
ğŸ”¹ 4. Deploy AWS Infrastructure with Terraform
bash
Copy
Edit
cd terraform
terraform init
terraform apply
This will provision:

ECS Cluster & Fargate service

IAM roles

ECS Task Definition

Networking (you provide existing subnet IDs & security group)

ğŸ”¹ 5. Set Up GitHub Repository
Create a new GitHub repo

Push your local files:

bash
Copy
Edit
git init
git remote add origin https://github.com/YOUR_USERNAME/medusa-aws-deployment.git
git add .
git commit -m "Initial commit"
git push -u origin main
ğŸ”¹ 6. Add GitHub Secrets for CI/CD
Go to: GitHub â†’ Repo â†’ Settings â†’ Secrets â†’ Actions â†’ New repository secret

Add the following:

Name	Value
AWS_ACCESS_KEY_ID	Your AWS Access Key ID
AWS_SECRET_ACCESS_KEY	Your AWS Secret Key
ğŸ”¹ 7. Trigger GitHub Actions Pipeline
Whenever you push code to the main branch, the workflow at .github/workflows/deploy.yml will:

Build Docker image

Push to ECR

Force ECS Fargate to redeploy latest container

ğŸ”¹ 8. Access the Medusa Backend
Get the public IP of your ECS service (from the AWS Console).

Access the Medusa backend:

arduino
Copy
Edit
http://<public-ip>:9000/store/products
ğŸ¥ Video Walkthrough
ğŸ“¹ Link to Video: [Add your YouTube link here â€” must show your face and explain each part]

ğŸ§¼ Cleanup
To destroy the infrastructure and avoid charges:

bash
Copy
Edit
cd terraform
terraform destroy
ğŸ“ Notes
The Dockerfile assumes a Node.js project is present in medusa-server/.

You can use the Medusa starter CLI:

bash
Copy
Edit
npx create-medusa-app@latest
Let me know if you'd like me to convert this into a downloadable .md file or directly push this into your GitHub repo's README.md.








